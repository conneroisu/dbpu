# go-dbpu

Golang database per user for turso db.

<img src='./assets/dbpu.png' width='50'>

## Installation

```bash
go get github.com/conneroisu/dbpu
```

## Usage

See examples for more details.

<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# dbpu

```go
import "github.com/conneroisu/dbpu"
```

Package dbpu is a package providing database per user utilities for turso.

Allows for management of the turso api in the context of working with databases, tokens, groups, locations, orgs, and regions.

## Index

- [func WithAuthorization\(authorization string\) func\(\*TokenConfig\)](<#WithAuthorization>)
- [func WithExpiration\(expiration string\) func\(\*TokenConfig\)](<#WithExpiration>)
- [type Client](<#Client>)
  - [func NewClient\(apiToken, orgName string\) \*Client](<#NewClient>)
  - [func \(c \*Client\) Create\(ctx context.Context, config Config\) \(\*Database, error\)](<#Client.Create>)
  - [func \(c \*Client\) CreateDatabaseToken\(ctx context.Context, dbName string, opts ...newDbTokenOpt\) \(string, error\)](<#Client.CreateDatabaseToken>)
- [type Config](<#Config>)
- [type Database](<#Database>)
- [type Seed](<#Seed>)
- [type TokenConfig](<#TokenConfig>)


<a name="WithAuthorization"></a>
## func [WithAuthorization](<https://github.com/conneroisu/dbpu/blob/main/databases.go#L88>)

```go
func WithAuthorization(authorization string) func(*TokenConfig)
```

WithAuthorization sets the authorization level for the token \(full\-access or read\-only\).

<a name="WithExpiration"></a>
## func [WithExpiration](<https://github.com/conneroisu/dbpu/blob/main/databases.go#L83>)

```go
func WithExpiration(expiration string) func(*TokenConfig)
```

WithExpiration sets the expiration time for the token \(e.g., 2w1d30m\).

<a name="Client"></a>
## type [Client](<https://github.com/conneroisu/dbpu/blob/main/client.go#L14-L21>)

Client is a client for the dbpu API.

```go
type Client struct {
    BaseURL string // Base URL for API requests.
    OrgName string // Name of organization.
    // contains filtered or unexported fields
}
```

<a name="NewClient"></a>
### func [NewClient](<https://github.com/conneroisu/dbpu/blob/main/client.go#L27>)

```go
func NewClient(apiToken, orgName string) *Client
```

NewClient returns a new client.

Base URL is the base URL for API requests. Region URL is the base URL for region requests.

<a name="Client.Create"></a>
### func \(\*Client\) [Create](<https://github.com/conneroisu/dbpu/blob/main/databases.go#L49>)

```go
func (c *Client) Create(ctx context.Context, config Config) (*Database, error)
```

Create creates a database with the given name and group.

Options can be provided to configure the database such as location, image, extensions, seed, schema, and isSchema.

<a name="Client.CreateDatabaseToken"></a>
### func \(\*Client\) [CreateDatabaseToken](<https://github.com/conneroisu/dbpu/blob/main/databases.go#L94-L98>)

```go
func (c *Client) CreateDatabaseToken(ctx context.Context, dbName string, opts ...newDbTokenOpt) (string, error)
```

CreateDatabaseToken creates a token for a database owned by an organization with an optional given expiration and authorization.

<a name="Config"></a>
## type [Config](<https://github.com/conneroisu/dbpu/blob/main/databases.go#L26-L35>)

Config is a struct configures the creation of a database.

```go
type Config struct {
    Name       string `json:"name" validate:"required"`
    Location   string `json:"location" validate:"required"`
    Image      string `json:"image,omitempty"`
    Extensions string `json:"extensions,omitempty"`
    Group      string `json:"group,omitempty"`
    Seed       *Seed  `json:"seed,omitempty"`
    Schema     string `json:"schema,omitempty"`
    IsSchema   bool   `json:"is_schema,omitempty"`
}
```

<a name="Database"></a>
## type [Database](<https://github.com/conneroisu/dbpu/blob/main/databases.go#L14-L23>)

Database is a libsql database.

```go
type Database struct {
    ID            string   `json:"DbId"`
    Hostname      string   `json:"Hostname"`
    Name          string   `json:"Name"`
    Group         string   `json:"group"`
    PrimaryRegion string   `json:"primaryRegion"`
    Regions       []string `json:"regions"`
    Type          string   `json:"type"`
    Version       string   `json:"version"`
}
```

<a name="Seed"></a>
## type [Seed](<https://github.com/conneroisu/dbpu/blob/main/databases.go#L38-L43>)

Seed is a seed for a database.

```go
type Seed struct {
    Type      string     `json:"type"`
    Name      string     `json:"value,omitempty"`
    URL       string     `json:"url,omitempty"`
    Timestamp *time.Time `json:"timestamp,omitempty"`
}
```

<a name="TokenConfig"></a>
## type [TokenConfig](<https://github.com/conneroisu/dbpu/blob/main/databases.go#L74-L79>)

TokenConfig is a configuration for creating a database token.

```go
type TokenConfig struct {
    // contains filtered or unexported fields
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->

